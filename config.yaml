# Конфигурация Home Assistant Add-on
# https://developers.home-assistant.io/docs/add-ons/configuration

name: "Crypto Inspect"
description: "Сбор и анализ данных криптовалютных свечей"
version: "1.0.1"
slug: "crypto_inspect"
url: "https://github.com/Mesteriis/crypto-inspector"
init: false
arch:
  - amd64
  - aarch64
homeassistant_api: true
ingress: true
ingress_port: 9999
panel_icon: "mdi:bitcoin"
panel_title: "Crypto Inspect"

services:
  - mysql:want

ports:
  9999/tcp: 9999
  9998/tcp: 9998
  6053/tcp: 6053
ports_description:
  9999/tcp: "API порт для сенсоров Home Assistant"
  9998/tcp: "MCP сервер для интеграции с AI-агентами"
  6053/tcp: "ESPHome Native API для авто-обнаружения"

# Минимальные настройки - всё работает из коробки
options:
  mcp_enabled: true
  symbols:
    # === Основные ===
    - "BTCUSDT"    # Bitcoin - цифровое золото
    - "ETHUSDT"    # Ethereum - смарт-контракты #1
    # === Перспективные L1 ===
    - "SOLUSDT"    # Solana - скорость + DeFi + NFT
    - "TONUSDT"    # TON - Telegram экосистема, 900м пользователей
    # === AI инфраструктура ===
    - "RENDERUSDT" # Render - GPU вычисления для AI
    - "TAOUSDT"    # Bittensor - децентрализованный AI
    - "ARUSDT"     # Arweave - вечное хранилище данных
    # === AI агенты ===
    - "FETUSDT"    # Fetch.ai - автономные AI агенты
    - "NEARUSDT"   # NEAR - L1 с AI фокусом (NEAR AI)
    - "INJUSDT"    # Injective - DeFi + AI трейдинг

# Схема с дефолтами - все поля опциональны
schema:
  # === Основные ===
  api_port: port?
  log_level: list(debug|info|warning|error)?
  symbols:
    - str

  # === База данных ===
  database_type: list(sqlite|postgres)?
  postgres_host: str?
  postgres_port: port?
  postgres_database: str?
  postgres_username: str?
  postgres_password: password?
  redis_url: str?

  # === Анализ рынка ===
  fetch_interval_minutes: int(1,1440)?
  analysis_enabled: bool?
  analysis_interval_hours: int(1,24)?
  alert_on_strong_signals: bool?
  alert_threshold_buy: int(50,100)?
  alert_threshold_sell: int(0,50)?

  # === Биржи ===
  bybit_api_key: password?
  bybit_api_secret: password?
  bybit_testnet: bool?

  # === API Server ===
  api_enabled: bool?

  # === MCP Server ===
  mcp_enabled: bool?
  mcp_port: port?

  # === Загрузка истории ===
  backfill_enabled: bool?
  backfill_crypto_years: int(1,15)?
  backfill_traditional_years: int(1,5)?

  # === AI анализ ===
  ai_enabled: bool?
  ai_provider: list(ollama|openai)?
  openai_api_key: password?
  ollama_host: str?
  ollama_model: str?
  ai_analysis_interval_hours: int(1,168)?
  ai_language: list(en|ru)?

  # === Цели и уведомления ===
  goal_enabled: bool?
  goal_target_value: int(1000,100000000)?
  goal_name: str?
  briefing_morning_enabled: bool?
  briefing_evening_enabled: bool?
  notification_mode: list(all|smart|digest_only|critical_only|silent)?

map:
  - config:ro
  - ssl:ro
  - share:rw

startup: services
stage: stable
