# =============================================================================
# Ð‘Ð Ð˜Ð¤Ð˜ÐÐ“Ð˜ Ð˜ Ð Ð•Ð“Ð£Ð›Ð¯Ð ÐÐ«Ð• ÐžÐ¢Ð§ÐÐ¢Ð«
# =============================================================================
# ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð´Ð»Ñ Ñ€ÐµÐ³ÑƒÐ»ÑÑ€Ð½Ñ‹Ñ… ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ð¹

# -----------------------------------------------------------------------------
# 43. Ð£Ñ‚Ñ€ÐµÐ½Ð½Ð¸Ð¹ Ð±Ñ€Ð¸Ñ„Ð¸Ð½Ð³
# -----------------------------------------------------------------------------
- id: crypto_morning_briefing
  alias: "Crypto: Ð£Ñ‚Ñ€ÐµÐ½Ð½Ð¸Ð¹ Ð±Ñ€Ð¸Ñ„Ð¸Ð½Ð³"
  description: "Ð•Ð¶ÐµÐ´Ð½ÐµÐ²Ð½Ñ‹Ð¹ ÑƒÑ‚Ñ€ÐµÐ½Ð½Ð¸Ð¹ Ð¾Ð±Ð·Ð¾Ñ€ Ñ€Ñ‹Ð½ÐºÐ°"
  trigger:
    - platform: time
      at: "08:00:00"
  condition:
    - condition: state
      entity_id: input_boolean.crypto_briefings_enabled
      state: "on"
  action:
    - service: notify.mobile_app
      data:
        title: "â˜€ï¸ Ð£Ñ‚Ñ€ÐµÐ½Ð½Ð¸Ð¹ Ð±Ñ€Ð¸Ñ„Ð¸Ð½Ð³"
        message: >
          {{ states('sensor.crypto_inspect_morning_briefing') }}
        data:
          tag: morning_briefing

# -----------------------------------------------------------------------------
# 44. Ð’ÐµÑ‡ÐµÑ€Ð½Ð¸Ð¹ Ð±Ñ€Ð¸Ñ„Ð¸Ð½Ð³
# -----------------------------------------------------------------------------
- id: crypto_evening_briefing
  alias: "Crypto: Ð’ÐµÑ‡ÐµÑ€Ð½Ð¸Ð¹ Ð±Ñ€Ð¸Ñ„Ð¸Ð½Ð³"
  description: "Ð•Ð¶ÐµÐ´Ð½ÐµÐ²Ð½Ñ‹Ð¹ Ð²ÐµÑ‡ÐµÑ€Ð½Ð¸Ð¹ Ð¾Ð±Ð·Ð¾Ñ€ Ð¸ Ð¸Ñ‚Ð¾Ð³Ð¸ Ð´Ð½Ñ"
  trigger:
    - platform: time
      at: "21:00:00"
  condition:
    - condition: state
      entity_id: input_boolean.crypto_briefings_enabled
      state: "on"
  action:
    - service: notify.mobile_app
      data:
        title: "ðŸŒ™ Ð’ÐµÑ‡ÐµÑ€Ð½Ð¸Ð¹ Ð¸Ñ‚Ð¾Ð³"
        message: >
          {{ states('sensor.crypto_inspect_evening_briefing') }}
        data:
          tag: evening_briefing

# -----------------------------------------------------------------------------
# 45. Ð•Ð¶ÐµÐ½ÐµÐ´ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ð¾Ñ‚Ñ‡Ñ‘Ñ‚
# -----------------------------------------------------------------------------
- id: crypto_weekly_summary
  alias: "Crypto: Ð•Ð¶ÐµÐ½ÐµÐ´ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ð¾Ñ‚Ñ‡Ñ‘Ñ‚"
  description: "ÐžÑ‚Ñ‡Ñ‘Ñ‚ Ð¿Ð¾ Ð²Ð¾ÑÐºÑ€ÐµÑÐµÐ½ÑŒÑÐ¼"
  trigger:
    - platform: time
      at: "18:00:00"
  condition:
    - condition: time
      weekday: [sun]
    - condition: state
      entity_id: input_boolean.crypto_briefings_enabled
      state: "on"
  action:
    - service: notify.mobile_app
      data:
        title: "ðŸ“Š ÐÐµÐ´ÐµÐ»Ñ Ð² ÐºÑ€Ð¸Ð¿Ñ‚Ð¾"
        message: "{{ states('sensor.crypto_inspect_weekly_insight') }}"

# -----------------------------------------------------------------------------
# 46. FOMC Ð½Ð°Ð¿Ð¾Ð¼Ð¸Ð½Ð°Ð½Ð¸Ðµ (Ð·Ð° Ð´ÐµÐ½ÑŒ)
# -----------------------------------------------------------------------------
- id: crypto_fomc_reminder
  alias: "Crypto: FOMC Ð·Ð°Ð²Ñ‚Ñ€Ð°"
  description: "ÐÐ°Ð¿Ð¾Ð¼Ð¸Ð½Ð°Ð½Ð¸Ðµ Ð¾ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð¾ÑÑ‰ÐµÐ¼ Ð·Ð°ÑÐµÐ´Ð°Ð½Ð¸Ð¸ Ð¤Ð Ð¡"
  trigger:
    - platform: numeric_state
      entity_id: sensor.crypto_inspect_days_to_fomc
      below: 2
  condition:
    - condition: template
      value_template: "{{ states('sensor.crypto_inspect_days_to_fomc') | int(999) == 1 }}"
  action:
    - service: notify.mobile_app
      data:
        title: "ðŸ›ï¸ FOMC Ð·Ð°Ð²Ñ‚Ñ€Ð°!"
        message: "Ð—Ð°ÑÐµÐ´Ð°Ð½Ð¸Ðµ Ð¤Ð Ð¡ Ð·Ð°Ð²Ñ‚Ñ€Ð°. ÐžÐ¶Ð¸Ð´Ð°Ð¹ Ð¿Ð¾Ð²Ñ‹ÑˆÐµÐ½Ð½ÑƒÑŽ Ð²Ð¾Ð»Ð°Ñ‚Ð¸Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ"
        data:
          priority: high

# -----------------------------------------------------------------------------
# 47. Ð’Ð°Ð¶Ð½Ð¾Ðµ Ð¼Ð°ÐºÑ€Ð¾ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ðµ
# -----------------------------------------------------------------------------
- id: crypto_macro_event
  alias: "Crypto: Ð’Ð°Ð¶Ð½Ð¾Ðµ Ð¼Ð°ÐºÑ€Ð¾ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ðµ"
  description: "Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ Ð¾ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð¾ÑÑ‰ÐµÐ¼ Ð²Ð°Ð¶Ð½Ð¾Ð¼ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¸"
  trigger:
    - platform: state
      entity_id: sensor.crypto_inspect_next_macro_event
  condition:
    - condition: template
      value_template: >
        {{ trigger.to_state.state not in ['unknown', 'unavailable', 'none'] and
           state_attr('sensor.crypto_inspect_next_macro_event', 'hours_until') | default(999) < 24 }}
  action:
    - service: notify.mobile_app
      data:
        title: "ðŸ“… ÐœÐ°ÐºÑ€Ð¾ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ðµ"
        message: "Ð¡ÐºÐ¾Ñ€Ð¾: {{ states('sensor.crypto_inspect_next_macro_event') }}"

# -----------------------------------------------------------------------------
# 48. Token Unlock Ð¿Ñ€ÐµÐ´ÑƒÐ¿Ñ€ÐµÐ¶Ð´ÐµÐ½Ð¸Ðµ
# -----------------------------------------------------------------------------
- id: crypto_unlock_warning
  alias: "Crypto: Token Unlock ÑÐºÐ¾Ñ€Ð¾"
  description: "ÐŸÑ€ÐµÐ´ÑƒÐ¿Ñ€ÐµÐ¶Ð´ÐµÐ½Ð¸Ðµ Ð¾ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð¾ÑÑ‰ÐµÐ¹ Ñ€Ð°Ð·Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐµ Ñ‚Ð¾ÐºÐµÐ½Ð¾Ð²"
  trigger:
    - platform: state
      entity_id: sensor.crypto_inspect_unlocks_next_event
  condition:
    - condition: template
      value_template: >
        {{ state_attr('sensor.crypto_inspect_unlocks_next_event', 'days_until') | default(999) < 3 }}
  action:
    - service: notify.mobile_app
      data:
        title: "ðŸ”“ Token Unlock"
        message: "{{ states('sensor.crypto_inspect_unlocks_next_event') }} - Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾Ðµ Ð´Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð½Ð° Ñ†ÐµÐ½Ñƒ"

# -----------------------------------------------------------------------------
# 49. Ð’Ñ‹ÑÐ¾ÐºÐ¸Ð¹ Ð¼Ð°ÐºÑ€Ð¾ Ñ€Ð¸ÑÐº Ð½Ð° Ð½ÐµÐ´ÐµÐ»Ðµ
# -----------------------------------------------------------------------------
- id: crypto_macro_risk_high
  alias: "Crypto: Ð’Ñ‹ÑÐ¾ÐºÐ¸Ð¹ Ð¼Ð°ÐºÑ€Ð¾ Ñ€Ð¸ÑÐº"
  description: "ÐœÐ½Ð¾Ð³Ð¾ Ð²Ð°Ð¶Ð½Ñ‹Ñ… ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ Ð½Ð° Ð½ÐµÐ´ÐµÐ»Ðµ"
  trigger:
    - platform: state
      entity_id: sensor.crypto_inspect_macro_risk_week
      to: "high"
  action:
    - service: notify.mobile_app
      data:
        title: "âš ï¸ ÐœÐ°ÐºÑ€Ð¾ Ñ€Ð¸ÑÐº Ð²Ñ‹ÑÐ¾ÐºÐ¸Ð¹"
        message: "ÐœÐ½Ð¾Ð³Ð¾ Ð²Ð°Ð¶Ð½Ñ‹Ñ… ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ Ð½Ð° ÑÑ‚Ð¾Ð¹ Ð½ÐµÐ´ÐµÐ»Ðµ. Ð‘ÑƒÐ´ÑŒ Ð¾ÑÑ‚Ð¾Ñ€Ð¾Ð¶ÐµÐ½ Ñ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑÐ¼Ð¸"

# -----------------------------------------------------------------------------
# 50. AI Ð°Ð½Ð°Ð»Ð¸Ð· Ð³Ð¾Ñ‚Ð¾Ð²
# -----------------------------------------------------------------------------
- id: crypto_ai_analysis_ready
  alias: "Crypto: AI Ð°Ð½Ð°Ð»Ð¸Ð· Ð³Ð¾Ñ‚Ð¾Ð²"
  description: "ÐÐ¾Ð²Ñ‹Ð¹ AI Ð°Ð½Ð°Ð»Ð¸Ð· Ñ€Ñ‹Ð½ÐºÐ° Ð´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½"
  trigger:
    - platform: state
      entity_id: sensor.crypto_inspect_ai_last_analysis
  condition:
    - condition: template
      value_template: >
        {{ trigger.to_state.state != trigger.from_state.state and
           trigger.to_state.state not in ['unknown', 'unavailable'] }}
  action:
    - service: notify.mobile_app
      data:
        title: "ðŸ¤– AI Ð°Ð½Ð°Ð»Ð¸Ð·"
        message: "{{ states('sensor.crypto_inspect_ai_recommendation') }}"
